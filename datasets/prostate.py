import os
import glob
import torch
from torch_geometric.data import Dataset
from torch_geometric.data import Data, DataListLoader,DataLoader
from torch_geometric.nn import radius_graph
import random
import sys
import os
import numpy as np
from tqdm import tqdm


#mean = [0.0628, 0.0511, 0.0442, 0.0728, 0.0441, 0.0507, 0.0612, 0.0603, 0.0773,
#        0.0626, 0.0679, 0.0423, 0.0881, 0.0549, 0.0605, 0.0570, 0.0600, 0.0602,
#        0.0516, 0.0310, 0.0618, 0.0598, 0.0478, 0.0699, 0.0640, 0.0400, 0.0467,
#        0.0859, 0.0428, 0.0751, 0.0539, 0.0349, 0.0595, 0.0582, 0.0750, 0.0611,
#        0.0515, 0.0638, 0.0532, 0.0605, 0.0507, 0.0596, 0.0613, 0.0578, 0.0731,
#        0.0624, 0.0550, 0.0382, 0.0615, 0.0372, 0.0472, 0.0432, 0.0527, 0.0532,
#        0.0313, 0.0420, 0.0726, 0.0415, 0.0610, 0.0739, 0.0508, 0.0527, 0.0447,
#        0.0429, 0.0502, 0.0671, 0.0767, 0.0491, 0.0585, 0.0591, 0.0451, 0.0548,
#        0.0514, 0.0507, 0.0554, 0.0644, 0.0505, 0.0293, 0.0520, 0.0496, 0.0496,
#        0.0381, 0.0590, 0.0582, 0.0306, 0.0485, 0.0718, 0.0546, 0.0674, 0.0479,
#        0.0505, 0.0505, 0.0651, 0.0573, 0.0417, 0.0673, 0.0405, 0.0976, 0.0514,
#        0.0359, 0.0480, 0.0407, 0.0702, 0.0492, 0.0506, 0.0285, 0.0651, 0.0665,
#        0.0708, 0.0328, 0.0425, 0.0549, 0.0490, 0.0336, 0.0457, 0.0556, 0.0472,
#        0.0576, 0.0631, 0.0761, 0.0327, 0.0443, 0.0509, 0.0303, 0.0542, 0.0603,
#        0.0520, 0.0437, 0.0705, 0.0644, 0.0502, 0.0552, 0.0759, 0.0503, 0.0411,
#        0.0660, 0.0469, 0.0472, 0.0330, 0.0536, 0.0548, 0.0802, 0.0559, 0.0671,
#        0.0591, 0.0509, 0.0425, 0.0568, 0.0603, 0.0607, 0.0488, 0.0528, 0.0418,
#        0.0555, 0.0573, 0.0478, 0.0606, 0.0380, 0.0522, 0.0442, 0.0449, 0.0502,
#        0.0357, 0.0650, 0.0642, 0.0536, 0.0803, 0.0537, 0.0384, 0.0558, 0.0542,
#        0.0424, 0.0465, 0.0611, 0.0426, 0.0334, 0.0584, 0.0595, 0.0514, 0.0441,
#        0.0514, 0.0520, 0.0404, 0.0386, 0.0519, 0.0326, 0.0538, 0.0489, 0.0443,
#        0.0487, 0.0658, 0.0696, 0.0591, 0.0396, 0.0620, 0.0750, 0.0419, 0.0466,
#        0.0313, 0.0558, 0.0400, 0.0521, 0.0659, 0.0557, 0.0586, 0.0580, 0.0574,
#        0.0500, 0.0314, 0.0593, 0.0553, 0.0432, 0.0537, 0.0495, 0.0433, 0.0445,
#        0.0436, 0.0463, 0.0847, 0.0627, 0.0665, 0.0577, 0.0548, 0.0444, 0.0677,
#        0.0416, 0.0610, 0.0541, 0.0478, 0.0524, 0.0421, 0.0970, 0.0677, 0.0449,
#        0.0470, 0.0670, 0.0620, 0.0762, 0.0664, 0.0602, 0.0333, 0.0566, 0.0357,
#        0.0351, 0.0352, 0.0438, 0.0349, 0.0764, 0.0278, 0.0534, 0.0405, 0.0522,
#        0.0586, 0.0475, 0.0563, 0.0624, 0.0412, 0.0599, 0.0594, 0.0330, 0.0308,
#        0.0698, 0.0470, 0.0488, 0.0538, 0.0501, 0.0989, 0.0619, 0.0480, 0.0624,
#        0.0619, 0.0448, 0.0577, 0.0790, 0.0829, 0.0511, 0.0633, 0.0742, 0.0575,
#        0.0575, 0.0424, 0.0653, 0.0421, 0.0480, 0.0451, 0.0615, 0.0661, 0.0501,
#        0.0664, 0.0315, 0.0547, 0.0314, 0.0417, 0.0354, 0.0860, 0.0478, 0.0501,
#        0.0516, 0.0519, 0.0748, 0.0612, 0.0751, 0.0481, 0.0455, 0.0517, 0.0385,
#        0.0562, 0.0590, 0.0673, 0.0610, 0.0484, 0.0465, 0.0514, 0.0556, 0.0505,
#        0.0464, 0.0736, 0.0498, 0.0412, 0.0679, 0.0554, 0.0580, 0.0515, 0.0392,
#        0.0496, 0.0678, 0.0574, 0.0502, 0.0593, 0.0583, 0.0705, 0.0715, 0.0488,
#        0.0497, 0.0518, 0.0458, 0.0474, 0.0647, 0.0446, 0.0422, 0.0373, 0.0524,
#        0.0793, 0.0419, 0.0492, 0.0448, 0.0362, 0.0493, 0.0636, 0.0697, 0.0556,
#        0.0611, 0.0427, 0.0659, 0.0452, 0.0593, 0.0468, 0.0508, 0.0393, 0.0434,
#        0.0683, 0.0862, 0.0564, 0.0351, 0.0499, 0.0764, 0.0484, 0.0522, 0.0538,
#        0.0370, 0.0430, 0.0387, 0.0543, 0.0533, 0.0463, 0.0903, 0.0431, 0.0610,
#        0.0428, 0.0842, 0.0525, 0.0504, 0.0621, 0.0484, 0.0625, 0.0548, 0.0672,
#        0.0422, 0.0685, 0.0583, 0.0541, 0.0300, 0.0373, 0.0513, 0.0467, 0.0396,
#        0.0576, 0.0589, 0.0382, 0.0399, 0.0653, 0.0708, 0.0735, 0.0599, 0.0423,
#        0.0472, 0.0516, 0.0572, 0.0482, 0.0762, 0.0636, 0.0562, 0.0650, 0.0520,
#        0.0555, 0.0630, 0.0516, 0.0681, 0.0508, 0.0682, 0.0482, 0.0535, 0.0492,
#        0.0514, 0.0484, 0.0481, 0.0644, 0.0615, 0.0409, 0.0350, 0.0521, 0.0633,
#        0.0790, 0.0650, 0.0377, 0.0464, 0.0412, 0.0476, 0.0322, 0.0444, 0.0410,
#        0.0359, 0.0370, 0.0466, 0.0550, 0.0584, 0.0453, 0.0374, 0.0516, 0.0874,
#        0.0521, 0.0455, 0.0399, 0.0675, 0.0406, 0.0504, 0.0442, 0.0511, 0.0438,
#        0.0833, 0.0524, 0.0633, 0.0354, 0.0572, 0.0649, 0.0506, 0.0487, 0.0556,
#        0.0378, 0.0576, 0.0390, 0.0641, 0.0652, 0.0516, 0.0488, 0.0558, 0.0616,
#        0.0530, 0.0507, 0.0579, 0.0442, 0.0401, 0.0479, 0.0487, 0.0723, 0.0444,
#        0.0305, 0.0495, 0.0672, 0.0482, 0.0532, 0.0382, 0.0606, 0.0674, 0.0416,
#        0.0445, 0.0699, 0.0512, 0.0449, 0.0601, 0.0731, 0.0560, 0.0492, 0.0525,
#        0.0987, 0.0466, 0.0359, 0.0408, 0.0629, 0.0699, 0.0465, 0.0340]
#std = [2.2128e-03, 6.4942e-04, 2.3384e-04, 6.3293e-04, 6.4936e-04, 5.1066e-04,
#        6.0743e-04, 8.4921e-04, 2.8778e-03, 1.4233e-03, 2.9221e-04, 1.1867e-04,
#        9.0403e-04, 3.7491e-04, 1.0040e-03, 1.0143e-03, 1.5953e-03, 1.0807e-03,
#        4.1203e-04, 1.2027e-03, 3.6228e-04, 4.6826e-04, 7.4208e-04, 2.1043e-03,
#        1.3979e-03, 5.5545e-04, 3.9562e-04, 1.3728e-03, 7.8741e-04, 6.9774e-04,
#        1.6285e-04, 2.4904e-04, 2.4506e-04, 7.9236e-04, 2.9969e-03, 1.0254e-03,
#        7.1478e-05, 7.3329e-04, 1.4546e-03, 1.6946e-04, 6.4689e-04, 6.3195e-04,
#        2.0065e-04, 3.8725e-04, 1.7614e-03, 1.9442e-04, 3.0825e-04, 8.1776e-04,
#        1.3974e-04, 7.7677e-04, 7.2292e-04, 9.4641e-05, 9.2763e-04, 9.0511e-04,
#        4.0571e-04, 9.5489e-04, 8.7446e-04, 7.0593e-04, 5.0570e-04, 5.9076e-04,
#        3.6673e-04, 5.9886e-04, 3.6291e-04, 9.5345e-04, 8.4703e-04, 2.3761e-03,
#        2.0041e-04, 9.7725e-04, 1.2790e-03, 5.8398e-04, 1.2534e-04, 1.3692e-03,
#        1.2041e-03, 2.1054e-04, 3.7938e-04, 3.9248e-04, 6.5514e-04, 2.7163e-04,
#        1.3396e-03, 1.7782e-03, 2.0484e-04, 1.7481e-04, 2.8589e-04, 7.0293e-04,
#        5.7131e-04, 5.1714e-04, 4.3151e-04, 5.7197e-04, 1.4289e-03, 4.4917e-04,
#        6.1502e-04, 1.2121e-03, 7.1850e-04, 6.0961e-04, 2.4064e-04, 3.2268e-04,
#        1.1953e-04, 4.6286e-03, 1.0510e-03, 1.1197e-04, 2.4540e-04, 1.0158e-03,
#        8.1771e-04, 4.9634e-04, 1.5274e-04, 7.3693e-04, 8.1550e-04, 1.9574e-03,
#        4.6435e-04, 5.1661e-04, 6.2734e-04, 2.9045e-04, 1.5705e-03, 3.8224e-04,
#        1.1631e-04, 1.8828e-04, 6.0368e-04, 6.1431e-04, 6.7128e-04, 9.0082e-04,
#        1.7560e-04, 5.7115e-04, 9.4837e-04, 4.8482e-04, 4.8716e-04, 2.8540e-04,
#        6.9070e-04, 1.8078e-04, 1.7108e-03, 1.4468e-04, 1.0744e-03, 1.2276e-03,
#        1.8314e-03, 1.0234e-03, 4.6088e-04, 1.7689e-03, 8.5819e-04, 6.3697e-04,
#        3.1913e-04, 7.4784e-04, 9.6855e-04, 1.6217e-03, 2.1787e-03, 1.2746e-03,
#        1.0047e-03, 1.2159e-03, 1.9409e-03, 3.1361e-04, 8.6873e-04, 7.1378e-04,
#        7.2128e-04, 4.2193e-04, 1.5785e-03, 4.7562e-04, 4.3873e-04, 1.7213e-04,
#        9.1806e-05, 4.1487e-04, 6.1293e-04, 6.3516e-04, 6.1082e-04, 1.2296e-03,
#        8.8354e-05, 1.0711e-03, 1.8370e-03, 3.2481e-04, 4.8463e-04, 9.4284e-04,
#        6.0300e-04, 5.1474e-04, 3.6936e-04, 3.5642e-04, 5.6970e-04, 7.6300e-04,
#        4.0382e-04, 2.5395e-04, 2.6231e-04, 1.0855e-03, 6.6712e-04, 6.0569e-04,
#        6.1537e-04, 2.7536e-04, 9.1381e-05, 2.2425e-04, 6.7845e-04, 8.2170e-05,
#        1.2234e-03, 2.8562e-04, 7.2475e-04, 5.5210e-04, 2.1964e-04, 4.7923e-04,
#        1.3144e-03, 8.5599e-04, 1.8696e-03, 4.5621e-04, 4.9534e-04, 4.9554e-04,
#        3.7804e-05, 8.4024e-04, 5.7103e-04, 2.9935e-04, 9.8660e-04, 2.0584e-04,
#        4.1663e-04, 2.9088e-04, 3.6399e-04, 1.4142e-03, 7.0612e-04, 2.0509e-03,
#        6.3343e-04, 4.5630e-04, 6.8303e-04, 1.9396e-03, 5.2102e-04, 5.2648e-04,
#        1.5667e-03, 4.5660e-04, 2.1742e-04, 1.3959e-03, 1.1962e-03, 3.4901e-04,
#        8.7781e-04, 1.0942e-04, 1.4262e-03, 8.2847e-04, 5.1536e-04, 5.4428e-04,
#        1.2175e-03, 4.5679e-04, 6.1545e-04, 1.2364e-03, 3.1956e-04, 1.5320e-04,
#        3.3897e-04, 1.3015e-03, 1.1511e-03, 1.7401e-03, 1.8943e-03, 4.5239e-04,
#        1.1923e-04, 6.6844e-04, 1.6848e-03, 9.4110e-04, 2.9146e-04, 3.0756e-04,
#        4.2619e-04, 1.4809e-04, 1.5615e-04, 3.4287e-04, 9.2318e-04, 1.4956e-03,
#        8.4213e-04, 2.7628e-04, 6.3953e-04, 2.5667e-03, 5.4221e-04, 1.9718e-03,
#        1.0578e-03, 2.5204e-04, 7.3665e-04, 2.4226e-03, 7.5290e-04, 8.6453e-04,
#        9.3975e-04, 1.0750e-03, 1.8691e-03, 3.3504e-04, 6.2365e-04, 9.4093e-04,
#        3.9673e-04, 5.4158e-04, 3.2336e-04, 2.2763e-03, 2.2787e-03, 1.0275e-03,
#        7.1696e-04, 1.4437e-03, 1.1885e-03, 3.9999e-04, 6.0083e-04, 9.0124e-04,
#        1.8584e-04, 1.2207e-04, 6.3395e-04, 1.1050e-03, 1.2679e-03, 1.0368e-03,
#        2.1853e-03, 4.2166e-04, 1.0183e-03, 5.1304e-04, 1.5813e-04, 4.6002e-04,
#        3.3751e-03, 2.1159e-04, 5.2150e-04, 4.6864e-04, 3.7189e-04, 1.3323e-03,
#        8.6520e-04, 9.9307e-04, 5.7093e-04, 9.4268e-04, 7.9569e-04, 2.7195e-04,
#        6.6857e-04, 1.1726e-03, 9.0510e-04, 1.3732e-03, 3.4653e-04, 4.0637e-04,
#        3.1221e-04, 1.4209e-03, 1.2610e-03, 5.3981e-04, 2.0284e-03, 1.4354e-03,
#        5.5829e-04, 8.5028e-04, 2.1924e-03, 6.0551e-04, 4.4279e-04, 2.8140e-04,
#        7.8450e-04, 8.3304e-04, 1.4193e-04, 4.0636e-04, 5.6489e-04, 9.6194e-04,
#        1.2283e-03, 4.8031e-04, 5.7008e-04, 8.0642e-04, 2.2378e-04, 5.1161e-04,
#        8.3234e-04, 8.1117e-04, 3.1460e-04, 7.3907e-04, 3.9063e-04, 6.7375e-04,
#        8.6285e-04, 5.0161e-04, 4.0172e-04, 4.5340e-04, 2.4666e-04, 6.2711e-04,
#        1.2197e-03, 5.6545e-04, 7.4757e-04, 8.0529e-04, 6.5456e-05, 1.3436e-03,
#        3.0232e-04, 1.1033e-03, 2.7897e-04, 1.6498e-03, 6.2037e-04, 5.8231e-04,
#        9.6897e-04, 1.1902e-03, 1.0582e-03, 1.9331e-04, 9.6303e-04, 2.6441e-03,
#        4.1291e-04, 1.2822e-03, 1.5046e-03, 3.8480e-04, 4.4789e-04, 2.2617e-04,
#        1.0003e-03, 7.2119e-04, 1.9473e-03, 7.4464e-04, 1.8916e-04, 1.5228e-03,
#        3.1190e-04, 6.6742e-04, 3.9619e-04, 3.5825e-04, 7.7897e-04, 5.9826e-04,
#        2.0630e-03, 1.8494e-03, 2.0336e-04, 2.7494e-04, 1.0469e-03, 3.1101e-03,
#        7.3502e-04, 3.8616e-05, 7.5479e-04, 1.0653e-03, 3.9440e-04, 3.7648e-04,
#        2.5437e-04, 1.4145e-03, 5.7551e-05, 2.8414e-04, 8.3992e-04, 5.2585e-04,
#        3.9631e-04, 1.3420e-03, 5.2969e-04, 1.0829e-03, 4.3082e-04, 1.0344e-03,
#        9.4492e-05, 1.9314e-04, 7.7604e-04, 2.1654e-04, 3.5948e-04, 8.6052e-04,
#        1.2173e-03, 3.4763e-04, 1.1986e-03, 6.3281e-04, 3.5917e-04, 1.9190e-03,
#        5.6599e-04, 9.2140e-04, 4.2022e-04, 6.2393e-04, 6.0351e-04, 1.1328e-03,
#        4.7401e-04, 5.3522e-04, 9.8518e-05, 3.3633e-04, 7.4713e-04, 8.3349e-04,
#        1.4804e-03, 2.2180e-04, 1.2683e-04, 5.2261e-04, 7.5230e-04, 3.2639e-04,
#        1.7011e-04, 5.0513e-04, 1.3902e-04, 3.4071e-04, 1.7698e-04, 3.4653e-04,
#        7.2758e-04, 1.6266e-04, 5.4734e-04, 5.6570e-04, 7.9544e-04, 9.4349e-04,
#        7.2054e-04, 6.9744e-04, 5.9783e-04, 6.3427e-04, 2.1404e-04, 3.7017e-04,
#        5.6172e-04, 7.1792e-04, 1.2597e-03, 2.2345e-03, 6.8264e-04, 9.2639e-04,
#        8.6289e-04, 5.3218e-04, 5.0286e-04, 9.8070e-04, 2.0788e-03, 8.5324e-04,
#        1.2057e-03, 8.2510e-04, 5.8623e-04, 6.1266e-04, 1.0108e-03, 1.1225e-03,
#        1.0772e-03, 1.2507e-03, 1.2666e-03, 4.1923e-04, 1.2361e-03, 4.4341e-04,
#        1.4030e-04, 5.1484e-04, 1.1565e-03, 3.1835e-04, 1.2453e-03, 2.1308e-04,
#        3.4530e-04, 3.6152e-04, 1.7989e-03, 1.9821e-03, 4.2226e-04, 2.1610e-04,
#        4.4019e-04, 1.2481e-03, 6.0190e-04, 7.5582e-04, 8.1038e-04, 6.7337e-04,
#        3.7200e-04, 6.0054e-04, 4.7378e-04, 1.3694e-03, 7.2696e-04, 7.3177e-04,
#        1.6677e-03, 3.2020e-04, 1.6440e-04, 4.7731e-04, 6.2271e-04, 5.0395e-04,
#        9.5574e-04, 2.7412e-04]

mean = [6.3039e-02, 5.1078e-02, 4.4181e-02, 7.2962e-02, 4.4039e-02, 5.0707e-02,
        6.1406e-02, 6.0387e-02, 7.7141e-02, 6.2593e-02, 6.8038e-02, 4.2335e-02,
        8.8251e-02, 5.4845e-02, 6.0708e-02, 5.6871e-02, 6.0402e-02, 6.0179e-02,
        5.1781e-02, 3.1081e-02, 6.2107e-02, 5.9691e-02, 4.7812e-02, 7.0224e-02,
        6.4160e-02, 4.0059e-02, 4.6730e-02, 8.5899e-02, 4.2958e-02, 7.5142e-02,
        5.4017e-02, 3.5008e-02, 5.9612e-02, 5.8476e-02, 7.5140e-02, 6.1241e-02,
        5.1442e-02, 6.3927e-02, 5.3349e-02, 6.0467e-02, 5.0754e-02, 5.9620e-02,
        6.1285e-02, 5.7869e-02, 7.2958e-02, 6.2358e-02, 5.5114e-02, 3.8302e-02,
        6.1633e-02, 3.7264e-02, 4.7347e-02, 4.3157e-02, 5.2705e-02, 5.3286e-02,
        3.1434e-02, 4.2173e-02, 7.2351e-02, 4.1789e-02, 6.0904e-02, 7.3976e-02,
        5.0859e-02, 5.2681e-02, 4.4836e-02, 4.3053e-02, 5.0110e-02, 6.7295e-02,
        7.6756e-02, 4.9331e-02, 5.8401e-02, 5.9049e-02, 4.5077e-02, 5.4971e-02,
        5.1600e-02, 5.0730e-02, 5.5492e-02, 6.4546e-02, 5.0487e-02, 2.9379e-02,
        5.1888e-02, 4.9608e-02, 4.9600e-02, 3.8082e-02, 5.8962e-02, 5.8351e-02,
        3.0606e-02, 4.8589e-02, 7.1891e-02, 5.4624e-02, 6.7531e-02, 4.7965e-02,
        5.0586e-02, 5.0591e-02, 6.5249e-02, 5.7415e-02, 4.1840e-02, 6.7327e-02,
        4.0527e-02, 9.7860e-02, 5.1577e-02, 3.5978e-02, 4.8086e-02, 4.0808e-02,
        7.0268e-02, 4.9165e-02, 5.0693e-02, 2.8619e-02, 6.5386e-02, 6.6732e-02,
        7.0935e-02, 3.2935e-02, 4.2656e-02, 5.4971e-02, 4.9046e-02, 3.3701e-02,
        4.5723e-02, 5.5695e-02, 4.7221e-02, 5.7536e-02, 6.3221e-02, 7.6085e-02,
        3.2755e-02, 4.4499e-02, 5.0980e-02, 3.0396e-02, 5.4361e-02, 6.0310e-02,
        5.2218e-02, 4.3864e-02, 7.0330e-02, 6.4530e-02, 5.0135e-02, 5.5433e-02,
        7.5853e-02, 5.0201e-02, 4.1037e-02, 6.5941e-02, 4.6939e-02, 4.7342e-02,
        3.2945e-02, 5.3756e-02, 5.4707e-02, 8.0296e-02, 5.6041e-02, 6.7165e-02,
        5.9338e-02, 5.1134e-02, 4.2553e-02, 5.6869e-02, 6.0151e-02, 6.0538e-02,
        4.8788e-02, 5.2730e-02, 4.2015e-02, 5.5452e-02, 5.7253e-02, 4.7943e-02,
        6.0665e-02, 3.8067e-02, 5.2354e-02, 4.4299e-02, 4.4798e-02, 5.0347e-02,
        3.5676e-02, 6.5233e-02, 6.4018e-02, 5.3700e-02, 8.0254e-02, 5.3660e-02,
        3.8523e-02, 5.6008e-02, 5.4314e-02, 4.2328e-02, 4.6493e-02, 6.1110e-02,
        4.2601e-02, 3.3433e-02, 5.8399e-02, 5.9428e-02, 5.1467e-02, 4.4172e-02,
        5.1598e-02, 5.2063e-02, 4.0481e-02, 3.8723e-02, 5.2052e-02, 3.2694e-02,
        5.4045e-02, 4.8933e-02, 4.4338e-02, 4.8832e-02, 6.5805e-02, 6.9737e-02,
        5.9263e-02, 3.9654e-02, 6.2106e-02, 7.5171e-02, 4.1885e-02, 4.6690e-02,
        3.1322e-02, 5.5966e-02, 3.9977e-02, 5.2014e-02, 6.5881e-02, 5.5717e-02,
        5.8595e-02, 5.8210e-02, 5.7656e-02, 5.0047e-02, 3.1482e-02, 5.9499e-02,
        5.5446e-02, 4.3338e-02, 5.3771e-02, 4.9810e-02, 4.3421e-02, 4.4361e-02,
        4.3797e-02, 4.6423e-02, 8.4707e-02, 6.2898e-02, 6.6800e-02, 5.7634e-02,
        5.5096e-02, 4.4385e-02, 6.7613e-02, 4.1890e-02, 6.1311e-02, 5.4211e-02,
        4.8009e-02, 5.2347e-02, 4.2109e-02, 9.6980e-02, 6.7940e-02, 4.4951e-02,
        4.6993e-02, 6.7197e-02, 6.2019e-02, 7.6417e-02, 6.6392e-02, 6.0257e-02,
        3.3295e-02, 5.6712e-02, 3.5916e-02, 3.5253e-02, 3.5210e-02, 4.3921e-02,
        3.4935e-02, 7.6456e-02, 2.7807e-02, 5.3614e-02, 4.0529e-02, 5.2432e-02,
        5.8847e-02, 4.7680e-02, 5.6080e-02, 6.2595e-02, 4.1330e-02, 5.9738e-02,
        5.9347e-02, 3.3105e-02, 3.0854e-02, 7.0030e-02, 4.7113e-02, 4.9019e-02,
        5.4107e-02, 5.0209e-02, 9.9218e-02, 6.1933e-02, 4.8185e-02, 6.2477e-02,
        6.1956e-02, 4.4713e-02, 5.7822e-02, 7.9346e-02, 8.2852e-02, 5.1268e-02,
        6.3407e-02, 7.4296e-02, 5.7538e-02, 5.7551e-02, 4.2518e-02, 6.5420e-02,
        4.2192e-02, 4.8028e-02, 4.5158e-02, 6.1311e-02, 6.6203e-02, 5.0189e-02,
        6.6632e-02, 3.1577e-02, 5.4919e-02, 3.1396e-02, 4.1677e-02, 3.5408e-02,
        8.6426e-02, 4.7710e-02, 5.0151e-02, 5.1749e-02, 5.1991e-02, 7.4727e-02,
        6.1124e-02, 7.5029e-02, 4.7990e-02, 4.5551e-02, 5.1743e-02, 3.8476e-02,
        5.6305e-02, 5.9082e-02, 6.7489e-02, 6.0898e-02, 4.8410e-02, 4.6493e-02,
        5.1455e-02, 5.5635e-02, 5.0628e-02, 4.6455e-02, 7.3483e-02, 4.9939e-02,
        4.1257e-02, 6.7915e-02, 5.5741e-02, 5.8083e-02, 5.1512e-02, 3.9155e-02,
        4.9799e-02, 6.7775e-02, 5.7424e-02, 5.0260e-02, 5.9432e-02, 5.8339e-02,
        7.0297e-02, 7.1633e-02, 4.8809e-02, 4.9767e-02, 5.1938e-02, 4.5929e-02,
        4.7345e-02, 6.4895e-02, 4.4647e-02, 4.2164e-02, 3.7383e-02, 5.2433e-02,
        7.9373e-02, 4.2018e-02, 4.9268e-02, 4.4924e-02, 3.6262e-02, 4.9263e-02,
        6.3817e-02, 6.9684e-02, 5.5593e-02, 6.1104e-02, 4.2757e-02, 6.5821e-02,
        4.5252e-02, 5.9344e-02, 4.6821e-02, 5.0989e-02, 3.9580e-02, 4.3301e-02,
        6.8120e-02, 8.6100e-02, 5.6456e-02, 3.5166e-02, 5.0151e-02, 7.6640e-02,
        4.8315e-02, 5.2372e-02, 5.3800e-02, 3.7145e-02, 4.3041e-02, 3.8787e-02,
        5.4375e-02, 5.3386e-02, 4.6501e-02, 9.0343e-02, 4.3128e-02, 6.1214e-02,
        4.2864e-02, 8.4327e-02, 5.2519e-02, 5.0405e-02, 6.2290e-02, 4.8317e-02,
        6.2756e-02, 5.5041e-02, 6.7197e-02, 4.2264e-02, 6.8550e-02, 5.8489e-02,
        5.4101e-02, 3.0055e-02, 3.7380e-02, 5.1483e-02, 4.6786e-02, 3.9674e-02,
        5.7704e-02, 5.8825e-02, 3.8279e-02, 4.0008e-02, 6.5271e-02, 7.0764e-02,
        7.3558e-02, 5.9871e-02, 4.2253e-02, 4.7395e-02, 5.1513e-02, 5.7226e-02,
        4.8249e-02, 7.6191e-02, 6.3819e-02, 5.6304e-02, 6.5245e-02, 5.1956e-02,
        5.5663e-02, 6.3020e-02, 5.1768e-02, 6.7979e-02, 5.0760e-02, 6.8220e-02,
        4.8153e-02, 5.3477e-02, 4.9179e-02, 5.1447e-02, 4.8321e-02, 4.8239e-02,
        6.4286e-02, 6.1406e-02, 4.0835e-02, 3.5093e-02, 5.2000e-02, 6.3370e-02,
        7.9142e-02, 6.4961e-02, 3.7731e-02, 4.6443e-02, 4.1214e-02, 4.7644e-02,
        3.2121e-02, 4.4456e-02, 4.0930e-02, 3.5867e-02, 3.7142e-02, 4.6731e-02,
        5.5042e-02, 5.8550e-02, 4.5385e-02, 3.7500e-02, 5.1670e-02, 8.7722e-02,
        5.2238e-02, 4.5677e-02, 3.9859e-02, 6.7540e-02, 4.0653e-02, 5.0585e-02,
        4.4143e-02, 5.1187e-02, 4.4050e-02, 8.3151e-02, 5.2372e-02, 6.3444e-02,
        3.5522e-02, 5.7202e-02, 6.4849e-02, 5.0853e-02, 4.8870e-02, 5.5795e-02,
        3.7846e-02, 5.7713e-02, 3.8998e-02, 6.4202e-02, 6.5363e-02, 5.1731e-02,
        4.8960e-02, 5.5753e-02, 6.1899e-02, 5.3069e-02, 5.0844e-02, 5.7772e-02,
        4.4218e-02, 4.0134e-02, 4.8154e-02, 4.8785e-02, 7.2237e-02, 4.4582e-02,
        3.0525e-02, 4.9548e-02, 6.7309e-02, 4.8452e-02, 5.3248e-02, 3.8276e-02,
        6.0566e-02, 6.7438e-02, 4.1731e-02, 4.4735e-02, 6.9923e-02, 5.1317e-02,
        4.4995e-02, 6.0032e-02, 7.3277e-02, 5.6175e-02, 4.9277e-02, 5.2592e-02,
        9.8883e-02, 4.6709e-02, 3.6039e-02, 4.0821e-02, 6.2943e-02, 6.9900e-02,
        4.6442e-02, 3.4013e-02, 7.9031e+02, 7.7442e+02]
std = [2.1493e-03, 6.5049e-04, 2.1906e-04, 6.3348e-04, 6.4822e-04, 4.9847e-04,
        6.2388e-04, 8.3213e-04, 2.8696e-03, 1.4042e-03, 2.9210e-04, 1.2083e-04,
        8.8801e-04, 3.7250e-04, 1.0228e-03, 1.0161e-03, 1.5558e-03, 1.0956e-03,
        4.0542e-04, 1.1868e-03, 3.5487e-04, 4.5711e-04, 7.4607e-04, 2.0421e-03,
        1.4151e-03, 5.5763e-04, 3.9821e-04, 1.3376e-03, 7.3444e-04, 7.0171e-04,
        1.6184e-04, 2.5165e-04, 2.3996e-04, 7.7288e-04, 3.0161e-03, 1.0224e-03,
        7.1882e-05, 7.3641e-04, 1.4295e-03, 1.6766e-04, 6.5435e-04, 6.2141e-04,
        2.0127e-04, 3.9005e-04, 1.7669e-03, 2.0069e-04, 2.9770e-04, 8.2574e-04,
        1.3554e-04, 7.5539e-04, 7.1802e-04, 8.8868e-05, 9.1184e-04, 8.9419e-04,
        4.3544e-04, 9.4708e-04, 8.4292e-04, 7.1570e-04, 5.0802e-04, 5.7728e-04,
        3.6910e-04, 6.0712e-04, 3.4981e-04, 9.4565e-04, 8.3301e-04, 2.3473e-03,
        2.1093e-04, 9.9390e-04, 1.2850e-03, 5.8671e-04, 1.2073e-04, 1.3717e-03,
        1.1476e-03, 2.0653e-04, 3.7538e-04, 3.8564e-04, 6.4995e-04, 2.7301e-04,
        1.3341e-03, 1.7253e-03, 2.0749e-04, 1.7499e-04, 2.7378e-04, 6.9084e-04,
        5.5451e-04, 5.0664e-04, 4.2203e-04, 5.7458e-04, 1.4268e-03, 4.4559e-04,
        6.0229e-04, 1.1941e-03, 7.3018e-04, 6.0504e-04, 2.3910e-04, 3.2103e-04,
        1.1910e-04, 4.6604e-03, 1.0356e-03, 1.1765e-04, 2.4442e-04, 9.8783e-04,
        8.0279e-04, 4.8749e-04, 1.5081e-04, 7.3804e-04, 8.0078e-04, 1.9234e-03,
        4.6538e-04, 5.1572e-04, 5.8456e-04, 2.8961e-04, 1.5398e-03, 3.7264e-04,
        1.1283e-04, 1.8735e-04, 6.3324e-04, 6.0148e-04, 6.4336e-04, 9.1091e-04,
        1.7795e-04, 5.8716e-04, 9.3559e-04, 4.7932e-04, 4.9727e-04, 2.8221e-04,
        6.7692e-04, 1.7497e-04, 1.6993e-03, 1.4658e-04, 1.0780e-03, 1.2405e-03,
        1.8434e-03, 1.0203e-03, 4.8774e-04, 1.7685e-03, 8.3715e-04, 6.5023e-04,
        3.0310e-04, 7.2638e-04, 9.5681e-04, 1.6022e-03, 2.2266e-03, 1.2832e-03,
        9.9414e-04, 1.2608e-03, 1.9388e-03, 3.1068e-04, 8.6315e-04, 7.0198e-04,
        7.2400e-04, 4.1185e-04, 1.5425e-03, 4.6550e-04, 4.3959e-04, 1.7248e-04,
        8.8222e-05, 4.1990e-04, 6.1021e-04, 6.4732e-04, 6.0486e-04, 1.2311e-03,
        8.8479e-05, 1.0724e-03, 1.8247e-03, 3.3232e-04, 4.8538e-04, 9.4896e-04,
        5.9641e-04, 5.1848e-04, 3.7508e-04, 3.6149e-04, 5.8001e-04, 7.5641e-04,
        4.0724e-04, 2.4706e-04, 2.6700e-04, 1.0911e-03, 6.6399e-04, 6.1768e-04,
        6.1895e-04, 2.6543e-04, 9.3687e-05, 2.2821e-04, 6.6440e-04, 8.4405e-05,
        1.2064e-03, 2.9058e-04, 7.1676e-04, 5.4478e-04, 2.1801e-04, 4.8434e-04,
        1.3132e-03, 8.3607e-04, 1.8811e-03, 4.5272e-04, 4.9243e-04, 4.9365e-04,
        3.8884e-05, 7.9504e-04, 5.7149e-04, 3.0560e-04, 9.8485e-04, 1.9743e-04,
        4.1590e-04, 2.9109e-04, 3.4908e-04, 1.3724e-03, 7.6424e-04, 1.9892e-03,
        6.5298e-04, 4.6037e-04, 6.8363e-04, 1.8877e-03, 5.4848e-04, 5.2482e-04,
        1.5596e-03, 4.5349e-04, 2.1509e-04, 1.4115e-03, 1.1880e-03, 3.4758e-04,
        8.6880e-04, 1.0697e-04, 1.4281e-03, 8.0950e-04, 5.0766e-04, 5.4923e-04,
        1.2218e-03, 4.7709e-04, 6.1672e-04, 1.2161e-03, 3.1198e-04, 1.5027e-04,
        3.2912e-04, 1.2860e-03, 1.1493e-03, 1.6980e-03, 1.9933e-03, 4.3956e-04,
        1.1705e-04, 6.6696e-04, 1.6511e-03, 9.1475e-04, 2.9001e-04, 3.0195e-04,
        4.2203e-04, 1.4862e-04, 1.5424e-04, 3.4328e-04, 8.9938e-04, 1.4535e-03,
        8.2515e-04, 2.7273e-04, 6.3097e-04, 2.6045e-03, 5.4577e-04, 1.9627e-03,
        1.0638e-03, 2.5581e-04, 7.3265e-04, 2.4472e-03, 7.5810e-04, 8.6979e-04,
        9.3249e-04, 1.0618e-03, 1.8070e-03, 3.3190e-04, 6.2932e-04, 9.3707e-04,
        3.9576e-04, 5.2373e-04, 3.1604e-04, 2.2611e-03, 2.2740e-03, 1.0431e-03,
        7.3304e-04, 1.4448e-03, 1.1964e-03, 4.0076e-04, 5.8622e-04, 9.0472e-04,
        1.8211e-04, 1.1828e-04, 6.4596e-04, 1.1131e-03, 1.2745e-03, 1.0387e-03,
        2.1856e-03, 4.1478e-04, 9.9909e-04, 5.2961e-04, 1.4903e-04, 4.4961e-04,
        3.3911e-03, 2.0719e-04, 5.0973e-04, 4.7437e-04, 3.6672e-04, 1.3059e-03,
        8.4290e-04, 9.7858e-04, 5.7619e-04, 9.5709e-04, 8.0659e-04, 2.7458e-04,
        7.0161e-04, 1.1995e-03, 8.7902e-04, 1.3607e-03, 3.4433e-04, 4.0830e-04,
        3.1301e-04, 1.4312e-03, 1.2594e-03, 5.4880e-04, 2.0380e-03, 1.3923e-03,
        5.5612e-04, 8.3744e-04, 2.1457e-03, 5.9948e-04, 4.4362e-04, 2.7680e-04,
        7.6848e-04, 8.3358e-04, 1.4606e-04, 4.0978e-04, 5.4827e-04, 9.8053e-04,
        1.2386e-03, 4.7033e-04, 5.7136e-04, 8.1583e-04, 2.0679e-04, 4.8940e-04,
        8.2072e-04, 8.2321e-04, 3.1064e-04, 7.4833e-04, 3.9084e-04, 6.8114e-04,
        8.6740e-04, 5.0638e-04, 4.0147e-04, 4.6162e-04, 2.4429e-04, 6.3472e-04,
        1.2304e-03, 5.5018e-04, 7.5616e-04, 8.1236e-04, 6.5152e-05, 1.3407e-03,
        2.9572e-04, 1.0832e-03, 2.7949e-04, 1.6986e-03, 6.2005e-04, 5.8327e-04,
        9.4670e-04, 1.1493e-03, 1.0620e-03, 1.9306e-04, 9.4717e-04, 2.6668e-03,
        4.0656e-04, 1.3107e-03, 1.5132e-03, 3.7775e-04, 4.4925e-04, 2.3469e-04,
        9.8950e-04, 7.2623e-04, 1.9631e-03, 7.5193e-04, 1.8921e-04, 1.5308e-03,
        3.2037e-04, 6.6031e-04, 3.9673e-04, 3.5825e-04, 7.6973e-04, 5.9700e-04,
        2.0222e-03, 1.7886e-03, 2.0155e-04, 2.6756e-04, 1.0500e-03, 3.0578e-03,
        7.4398e-04, 3.9579e-05, 7.4865e-04, 1.0825e-03, 3.9662e-04, 3.8195e-04,
        2.4565e-04, 1.4307e-03, 5.7377e-05, 2.8612e-04, 8.4914e-04, 5.1381e-04,
        3.8696e-04, 1.3414e-03, 5.3747e-04, 1.0561e-03, 4.3280e-04, 1.0387e-03,
        9.1099e-05, 1.8793e-04, 7.7651e-04, 2.2036e-04, 3.4838e-04, 8.5527e-04,
        1.1939e-03, 3.5306e-04, 1.2198e-03, 6.1848e-04, 3.5376e-04, 1.9609e-03,
        5.6574e-04, 9.2821e-04, 4.1961e-04, 6.2123e-04, 6.0672e-04, 1.1262e-03,
        4.6169e-04, 5.2917e-04, 9.5161e-05, 3.3037e-04, 7.4519e-04, 8.2242e-04,
        1.4825e-03, 2.1701e-04, 1.2578e-04, 5.2491e-04, 7.5332e-04, 3.2045e-04,
        1.7283e-04, 5.3152e-04, 1.4154e-04, 3.3939e-04, 1.7741e-04, 3.4618e-04,
        7.0713e-04, 1.5958e-04, 5.7034e-04, 5.7780e-04, 7.9846e-04, 9.4474e-04,
        7.2796e-04, 6.8771e-04, 5.9548e-04, 6.1876e-04, 2.1633e-04, 3.8243e-04,
        5.5684e-04, 7.3675e-04, 1.2088e-03, 2.1988e-03, 6.8123e-04, 9.2608e-04,
        8.4262e-04, 5.2372e-04, 4.9924e-04, 9.6386e-04, 2.1388e-03, 8.5692e-04,
        1.2203e-03, 8.1445e-04, 5.8334e-04, 6.2911e-04, 1.0180e-03, 1.0998e-03,
        1.0722e-03, 1.2562e-03, 1.2628e-03, 4.1866e-04, 1.2309e-03, 4.5148e-04,
        1.4395e-04, 4.9595e-04, 1.2537e-03, 3.1838e-04, 1.2335e-03, 2.0927e-04,
        3.3790e-04, 3.6357e-04, 1.8000e-03, 1.8874e-03, 4.1492e-04, 2.1633e-04,
        4.3373e-04, 1.3161e-03, 5.9004e-04, 7.6684e-04, 7.9188e-04, 6.3982e-04,
        3.6696e-04, 5.8788e-04, 4.6207e-04, 1.3589e-03, 7.4190e-04, 7.3031e-04,
        1.6395e-03, 3.0857e-04, 1.6361e-04, 4.7413e-04, 6.1554e-04, 4.9777e-04,
        9.5762e-04, 2.7785e-04, 1.8610e+05, 1.8251e+05]

class TCGAProstate(Dataset):
    def __init__(self, root, transforms=None):
        super().__init__(root)

        self.root = root
        #print('.....')
        #for fp in glob.iglob(search_path, recursive=True):
            #self.file_names.append(fp)
        #print('.....')
        self.transforms = transforms
        #self.epoch = 0
        self.idxlist = []
        self.fps = []
        search_path = os.path.join(self.root, '**', '*.pt')
        #print(search_path)
        for fp in glob.iglob(search_path, recursive=True):
            self.idxlist.append(os.path.basename(fp))
            self.fps.append(fp)
        self.mean = torch.tensor(mean)
        self.std = torch.tensor(std)
        #print(len(self))
        #self.root = os.path.join(root, '{}', 'proto', 'fix_full_cia_knn')

    def training_filepath(self):
        return self.fps
    #def set_epoch(self, epoch):
    #    self.epoch = epoch

    def len(self):
        return len(self.fps)

    def get(self, idx):
        fp = self.fps[idx]
        data = torch.load(fp)

        if self.transforms is not None:
            data = self.transforms(data)

        data.patch_idx = torch.tensor([idx])
        data.x = torch.cat([data.x, data.pos], dim=1)
        data.x = (data.x - self.mean) / self.std

        return data




#path = '/data/smb/syh/PycharmProjects/CGC-Net/data_baiyu/TCGA_Prostate/Cell_Graph/5Crops'
#dataset = TCGAProstate(path)
#
#print(dataset.len())
#
#count = 0
#
#for i in range(dataset.len()):
#    x = dataset.get(i)
#    count += len(x.x)
#    #print(len(x.x))
#
#print(count / dataset.len())